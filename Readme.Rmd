---
title: "MPG Analysis"
author: "Reza"
date: "20 May 2016"
output: pdf_document
---

#Summary
The goal of this study is to check whether automatic transmission has an impact on MPG in cars. We have a dataset of 32 cars with 11 measurement from each such as MPG, weight, displacement etc. We use regression analysis to check for the impact of transmission type on fuel consumption. 

At the end we will see that, although it seems at the first look that automatic transmission decreases MPG but this is not an statistically meaningful conclusion. 

#Data Explanation
The data was extracted from the 1974 Motor Trend US magazine, and includes fuel consumotion (mpg), Number of cylinders(cyl), Displacement (disp), Gross horsepower(hp), Rear axle ratio (drat), Weight (wt), 1/4 mile time (qsec), V/S (vs), Transmission (am, 0 = automatic, 1 = manual), Number of forward gears (gear), Number of carburetorsof (carb),  for 32 automobiles (1973-74 models).

```{r echo=FALSE, message=F}
library(caret)
data(mtcars)
mtcars$am <- factor(mtcars$am)
mtcars$vs <- factor(mtcars$vs)
```
Comparing the MPG of automatic transmissited cars vs manaully transsmitted ones (`r mean(mtcars$mpg[mtcars$am == 0])`, `r mean(mtcars$mpg[mtcars$am ==1])`) make us thick that automatic transsmission has a negaive imoact on fuel ecomomy. Bit let's take a look at MPG vs other variables 

Let's look at the rough relation between transmission type and fuel economy.

```{r echo=F, message=FALSE}
library(reshape)
meltedmtcars <- melt(mtcars, id.vars = c("mpg", "am"))
p <- ggplot(meltedmtcars, aes(x=value, y=mpg, color=am)) + geom_point()
p + facet_wrap( ~ variable, ncol = 3)
```

In particular in case of weight(wt) and rear axle ratio (drat) variables, one can see that they both have impact on MPG and on the other hand, they can roughly separate automatic and manually transmitted cars. In other words more weight means less mpg also cars with automatic transmission are heavier in this data set. So we use multivariable regression analysis to face this lack of data in the dataset.

#Regression analysis

For start we fit a linear model for mpg vs are other variables and look at the coefficients of the model.
```{r echo=F, message=F}
fitlm1 <- lm(mpg ~ ., data = mtcars)
round(coef(fitlm1),2)
```

It says that keeping other factors constant, the change from automatic transsmition to manuall increases mpg by `r round(coef(fitlm1)[9],2)` miles per gallon. But the confidence interval for this qoefiicent is (`r round(confint(fitlm1)[9,],2)`) containg $0$ which means that this improvement is not statisically significant. But there might be extra variables in the model which introduce extra variance. To seek for that we use the varible importance factor (VIF). These are the VIF for the model.

```{r echo=F, message=F}
library(car)
round(vif(fitlm1),2)
maxvif <- which(vif(fitlm1)==max(vif(fitlm1)))
```

`r names(vif(fitlm1))[maxvif]` has the most vif i.e. its impact on the model if $`r round(vif(fitlm1),2)[maxvif]`$ times more as if it was diagonal to other variables. Now we omit this variable and fit a new model.
```{r echo=F, message=F}
mtcars2 <- mtcars[, -(maxvif+1)]
fitlm2 <- lm(mpg ~ ., data = mtcars2)
round(coef(fitlm2),2)
```
Let us take a look at the VIF's of the new model.
```{r echo=F, message=F}
round(vif(fitlm2),2)
maxvif2 <- which(vif(fitlm2)==max(vif(fitlm2)))
```




